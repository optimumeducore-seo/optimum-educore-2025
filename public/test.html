<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <title>í•™ìƒ í…ŒìŠ¤íŠ¸</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body { font-family: system-ui, sans-serif; padding:16px; }
      input { padding:6px 8px; margin-right:6px; }
      button { padding:6px 10px; }
      ul { margin-top:16px; }
    </style>
  </head>
  <body>
    <h2>í•™ìƒ í…ŒìŠ¤íŠ¸</h2>
    <input id="name"   placeholder="ì´ë¦„" />
    <input id="grade"  placeholder="í•™ë…„" />
    <input id="school" placeholder="í•™êµ" />
    <button id="add">ì¶”ê°€</button>

    <ul id="list"></ul>

    <!-- âœ… ë°˜ë“œì‹œ CDN ê²½ë¡œë¡œ import -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
      import {
        getFirestore, collection, addDoc, onSnapshot, serverTimestamp
      } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

      // ğŸ”§ ë‹¹ì‹  í”„ë¡œì íŠ¸ ì„¤ì •
      const firebaseConfig = {
        apiKey: "AIzaSyCgMyqtp4Vlg6YWvDbQfRtTkG5xrgUO9x0",
        authDomain: "optimum-educore-2025.firebaseapp.com",
        projectId: "optimum-educore-2025",
        storageBucket: "optimum-educore-2025.appspot.com",
        messagingSenderId: "717693241717",
        appId: "1:717693241717:web:ecfd474f41271db992eb3c"
      };

      const app = initializeApp(firebaseConfig);
      const db  = getFirestore(app);

      const listEl = document.getElementById("list");

      // ğŸ”„ ì‹¤ì‹œê°„ ëª©ë¡
      onSnapshot(collection(db, "students"), (snap) => {
        listEl.innerHTML = "";
        snap.forEach((doc) => {
          const d = doc.data();
          const li = document.createElement("li");
          li.textContent = `${d.name} / ${d.grade} / ${d.school}`;
          listEl.appendChild(li);
        });
      });

      // â• ì¶”ê°€
      document.getElementById("add").addEventListener("click", async () => {
        const name   = document.getElementById("name").value.trim();
        const grade  = document.getElementById("grade").value.trim();
        const school = document.getElementById("school").value.trim();
        if (!name) return alert("ì´ë¦„ì€ í•„ìˆ˜!");

        await addDoc(collection(db, "students"), {
          name, grade, school, updatedAt: serverTimestamp()
        });

        document.getElementById("name").value = "";
      });
    </script>
  </body>
</html>